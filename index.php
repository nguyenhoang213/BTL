<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nhóm 6</title>
    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="css/footer.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<body>

    <?php
    include("connection.php");
    include("header.php");
    ?>
    <!-- body -->
    <div class="head-body">
        <div class="head-item">
            <p>DANH MỤC SẢN PHẨM</p>
        </div>
        <div class="main-item">
            <ul class="ul-head">
                <li class="li-head">
                    <a href="">
                        <img src="/BTL/src/assets/images/save-money-2.png" alt="" />
                        <div style="color: black"><b>CAM KẾT</b> <br />Giá Tốt Nhất</div>
                    </a>
                </li>
                <li class="li-head">
                    <a href="">
                        <img src="/BTL/src/assets/images/present.png" alt="" />
                        <div style="color: black"><b>MIỄN PHÍ</b> <br />Vận Chuyển</div>
                    </a>
                </li>
                <li class="li-head">
                    <a href="">
                        <img src="/BTL/src/assets/images/buy.png" alt="" />
                        <div style="color: black">
                            <b>THANH TOÁN</b> <br />Khi Nhận Hàng
                        </div>
                    </a>
                </li>
                <li class="li-head">
                    <a href="">
                        <img src="/BTL/src/assets/images/reload.png" alt="" />
                        <div style="color: black">
                            <b>ĐỔI TRẢ HÀNG</b> <br />Trong 3 Ngày
                        </div>
                    </a>
                </li>
                <li class="li-head">
                    <a href="">
                        <img src="/BTL/src/assets/images/repair-garage.png" alt="" />
                        <div style="color: black">
                            <b>BẢO HÀNH</b> <br />Tại Nơi Sử Dụng
                        </div>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="main">
        <div class="main-bd">
            <ul id="mega_menu" class="menu">
                <li id="menu-item-403">
                    <a href="/BTL/find_product.php?keyword=&category=DT"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/03/cate1_icon-24x24.png" />
                        <span>Điện thoại</span></a>
                    <ul class="sub-menu">
                        <li id="menu-item-404">
                            <a href="/BTL/find_product.php?keyword=&category=apple">
                                <span>Apple</span></a>
                        </li>
                        <li id="menu-item-408">
                            <a href="/BTL/find_product.php?keyword=&category=samsung">
                                <span>Samsung</span></a>
                        </li>
                        <li id="menu-item-405">
                            <a href="/BTL/find_product.php?keyword=&category=blackberry/">
                                <span>BlackBerry</span></a>
                        </li>
                        <li id="menu-item-406">
                            <a href="/BTL/find_product.php?keyword=&category=motorola/">
                                <span>Motorola</span></a>
                        </li>
                        <li id="menu-item-407">
                            <a href="/BTL/find_product.php?keyword=&category=nokia/">
                                <span>Nokia</span></a>
                        </li>
                    </ul>
                </li>
                <li id="menu-item-409">
                    <a href="/BTL/find_product.php?keyword=&category=LT"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2017/12/laptop-1.png" />
                        <span>Laptop</span></a>
                    <ul class="sub-menu">
                        <li id="menu-item-414"><a
                                href="/BTL/find_product.php?keyword=&category=macbook"><span>Macbook</span></a>
                        </li>
                        <li id="menu-item-410"><a href="/BTL/find_product.php?keyword=&category=laptopasus"><span>Laptop
                                    Asus</span></a>
                        </li>
                        <li id="menu-item-411"><a href="/BTL/find_product.php?keyword=&category=laptopdell"><span>Laptop
                                    Dell</span></a>
                        </li>
                        <li id="menu-item-412"><a href="/BTL/find_product.php?keyword=&category=laptophp"><span>Laptop
                                    HP</span></a></li>
                    </ul>
                </li>
                <li id="menu-item-421">
                    <a href="/BTL/find_product.php?keyword=&category=TL"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2017/12/tablet-outline-in-horizontal-position.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Tablet</span></a>
                    <ul class="sub-menu">
                        <li id="menu-item-425"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-ipad"><span>Tablet
                                    Ipad</span></a>
                        </li>
                        <li id="menu-item-422"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-beneve"><span>Tablet
                                    Beneve</span></a>
                        </li>
                        <li id="menu-item-426"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-itel"><span>Tablet
                                    Itel</span></a>
                        </li>
                        <li id="menu-item-427"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-kindle"><span>Tablet
                                    Kindle</span></a>
                        </li>
                        <li id="menu-item-428"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-mobell"><span>Tablet
                                    Mobell</span></a>
                        </li>
                        <li id="menu-item-429"><a
                                href="/BTL/find_product.php?keyword=&category=tablet-samsung"><span>Tablet
                                    Samsung</span></a>
                        </li>
                    </ul>
                </li>
                <li id="menu-item-415">
                    <a href="/BTL/find_product.php?keyword=&category=PK"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2017/12/headset.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Phụ
                            kiện</span></a>
                </li>
                <li id="menu-item-1564"><a href="/BTL/find_product.php?keyword=&category=SW"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/03/cate2_icon-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>SmartWatch</span></a></li>
                <li id="menu-item-1563"><a href="/BTL/find_product.php?keyword=&category=AW"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2017/12/smartphone.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Apple
                            Watch</span></a></li>
                <li id="menu-item-433" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-433"><a
                        href="/BTL/find_product.php?keyword=&category=MI"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2017/12/printer.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Thiết bị
                            máy
                            in</span></a></li>
                <li id="menu-item-434" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-434"><a
                        href="/BTL/find_product.php?keyword=&category=PC"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/ssd-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Máy tính
                            bộ,
                            màn hình</span></a></li>
                <li id="menu-item-420">
                    <a href="/BTL/find_product.php?keyword=&category=TN"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/cloud-computing-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Tai
                            nghe</span></a>
                </li>
                <li id="menu-item-2041"><a href="/BTL/find_product.php?keyword=&category=CM"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/processor-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Camera</span></a></li>
                <li id="menu-item-2042"><a href="/BTL/find_product.php?keyword=&category=LK"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/flash-disk-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Linh kiện
                            máy
                            tính</span></a></li>
                <li id="menu-item-2043"><a href="/BTL/find_product.php?keyword=&category=BP"><img width="24" height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/database-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Bàn
                            phím</span></a></li>
                <li id="menu-item-2044"><a href="/BTL/find_product.php?keyword=&category=mouse"><img width="24"
                            height="24"
                            src="https://mauweb.monamedia.net/hanoicomputer/wp-content/uploads/2019/06/pay-per-click-24x24.png"
                            class="menu-image menu-image-title-after" alt="" /><span>Chuột máy tính</span></a></li>
            </ul>
        </div>
        <!-- slider -->
        <?php
        // Truy vấn lấy tất cả các slider từ cơ sở dữ liệu
        $sql = "SELECT * FROM slider";
        $result = $conn->query($sql);
        ?>

        <div id="carouselExampleIndicators" class="carousel slide">
            <div class="carousel-indicators">
                <?php
                $index = 0;
                // Tạo các nút điều hướng (indicators)
                while ($row = $result->fetch_assoc()) {
                    $active = ($index === 0) ? 'active' : '';
                    echo "<button type='button' data-bs-target='#carouselExampleIndicators' data-bs-slide-to='{$index}' class='{$active}' aria-current='true' aria-label='Slide " . ($index + 1) . "'></button>";
                    $index++;
                }
                ?>
            </div>
            <div style="width: 910px; height: 570px" class="carousel-inner">
                <?php
                $result->data_seek(0); // Đặt lại chỉ số kết quả truy vấn để lặp lại từ đầu
                $index = 0;
                // Tạo các mục (items) của carousel
                while ($row = $result->fetch_assoc()) {
                    $active = ($index === 0) ? 'active' : '';
                    echo "
                    <div  class='carousel-item {$active}'>
                        <img src='./slider/{$row['slider_image']}' class='d-block w-100' alt='/{$row['slider_name']}' style='width: 910px; height: 570px;' />
                    </div>
                    ";
                    $index++;
                }
                ?>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        <!-- end slider -->
    </div>
    <!-- product -->
    <div class="container">
        <div class="menu0-product">
            <button class="main-title">SẢN PHẨM BÁN CHẠY</button>
        </div>
        <div class="products">
            <?php
            $sql_hot = "SELECT op.product_id, SUM(op.stock) as total_stock, p.image, p.product_name, p.price
                        FROM order_product op 
                        JOIN product p ON op.product_id = p.product_id
                        GROUP BY op.product_id 
                        ORDER BY total_stock DESC
                        LIMIT 8;
                        ";
            $result_hot = $conn->query($sql_hot);
            if ($result_hot->num_rows > 0) {
                while ($row_hot = $result_hot->fetch_assoc()) {
                    echo '
                    <div class="product-item">
                        <a href="/BTL/product/product_detail.php?id=' . $row_hot['product_id'] . '">
                        <img style="width: 170px; height: 170px" src="/BTL/src/assets/uploads/product/' . $row_hot['image'] . '">
                        <p>' . $row_hot['product_name'] . '</p>
                        <span>' . number_format($row_hot['price'], 0, ',', '.') . ' VNĐ </span>
                        </a>    
                    </div>
                    ';
                }
            }
            ?>
        </div>
    </div>
    <!-- Điện thoại -->
    <div class="container">
        <div class="menu1-product">
            <button class="main-title" value="DT">Điện thoại</button>
            <button class="active-product" value="apple">Apple</button>
            <button class="active-product" value="samsung">Samsung</button>
            <button class="active-product" value="blackberry">BlackBerry</button>
            <button class="active-product" value="motorola">Motorola</button>
            <button class="active-product" value="nokia">Nokia</button>
        </div>
        <div class="products" id="product-list-dt"></div>
    </div>

    <!-- Laptop -->
    <div class="container">
        <div class="menu2-product">
            <button class="main-title" value="LT">Laptop</button>
            <button class="active-product" value="macbook">Macbook</button>
            <button class="active-product" value="laptopasus">Laptop Asus</button>
            <button class="active-product" value="laptopdell">Laptop Dell</button>
            <button class="active-product" value="laptophp">Laptop HP</button>
        </div>
        <div class="products" id="product-list-lt"></div>
    </div>

         
    <script>
        // Đổi trạng thái active menu1
        const buttons = document.querySelectorAll('.menu1-product button');
        buttons.forEach(button => {
            button.addEventListener('click', function() {
                if (buttons[0].classList.contains('main-title')) {
                    buttons[0].classList.remove('main-title');
                    buttons[0].classList.add('active-product');
                }
                buttons.forEach(btn => btn.classList.remove('main-title'));
                this.classList.add('main-title');   
            });
        });
    </script>

    <script>
        // Đổi trạng thái active menu1
        const buttons2 = document.querySelectorAll('.menu2-product button');
        buttons2.forEach(button => {
            button.addEventListener('click', function() {
                if (buttons2[0].classList.contains('main-title')) {
                    buttons2[0].classList.remove('main-title');
                    buttons2[0].classList.add('active-product');
                }
                buttons2.forEach(btn => btn.classList.remove('main-title'));
                this.classList.add('main-title');   
            });
        });
    </script>

    <script>
        // Điện thoại
        document.querySelectorAll('.menu1-product button').forEach(button => {
            button.addEventListener('click', function () {
                const category = this.value;
                fetchProductsDT(category); // Gọi hàm lấy sản phẩm Điện thoại
            });
        });

        function fetchProductsDT(category) {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'fetch_product.php', true); // Gửi yêu cầu tới file PHP xử lý
            document.getElementById('product-list-dt').innerHTML = ''; // Xóa sản phẩm cũ
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send('category=' + category); // Gửi dữ liệu category

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    document.getElementById('product-list-dt').innerHTML = xhr.responseText;
                }
            };
        }

        // Laptop
        document.querySelectorAll('.menu2-product button').forEach(button => {
            button.addEventListener('click', function () {
                const category = this.value;
                fetchProductsLT(category); // Gọi hàm lấy sản phẩm Laptop
            });
        });

        function fetchProductsLT(category) {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'fetch_product.php', true); // Gửi yêu cầu tới file PHP xử lý
            document.getElementById('product-list-lt').innerHTML = ''; // Xóa sản phẩm cũ
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send('category=' + category); // Gửi dữ liệu category

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    document.getElementById('product-list-lt').innerHTML = xhr.responseText;
                }
            };
        }

        // Mặc định hiển thị sản phẩm Điện thoại khi trang tải
        window.onload = function () {
            fetchProductsDT('DT'); // Hiển thị sản phẩm Điện thoại mặc định
            fetchProductsLT('LT');
        };
    </script>

    <?php
    include("footer.php")
        ?>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous">
        </script>
</body>

</html>